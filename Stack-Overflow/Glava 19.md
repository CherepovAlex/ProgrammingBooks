# Глава 19. Класс BigDecimal

Класс `BigDecimal` (большие числа) представляет разработчику арифметические операции (сложение, вычитание, умножение, деление), а также операции с изменением точности - количество знаков после запятой (scale), округления, сравнения, хеширования и преобразования форматов. Класс `BigDecimal` представляет неизменяемые знаковые десятичные вещественные числа произвольной точности. Этот класс используется дял вычислений с крайне высокими требованиями к точности. 

## Раздел 19.1. Сравнение больших чисел

Для сравнения двух больших чисел (`BigDecimal`) следует использовать метод `compareTo`:

```java
BigDecimal a = new BigDecimal(5);
a.compareTo(new BigDecimal(0));     // а больше, возвращается 1
a.compareTo(new BigDecimal(5));     // а равно, возвращается 0
a.compareTo(new BigDecimal(10));     // а меньше, возвращается -1
```

При сравнении больших чисел не рекомендуется использовать метод `equals`, так как он считает два `BigDecimal` равными только в том случае, если они равны по значению, а также имеют одинаковую точность или масштаб (**scale**):

```java
BigDecimal a = new BigDecimal(5);
a.equals(new Decimal(5));       // значения и масштаб равны, возвращается true
a.equals(new BigDecimal(5.00)); // значения равны, а масштаб нет, возвращается false 
```

[к оглавлению Глава 19](#глава-19-класс-bigdecimal)

## Раздел 19.2. Использование значений BigDecimal вместо значений типа float

Из-за особенностей представления значений с плавающей точкой в памяти компьютера результаты операций с использованием типа `float` могут быть неточными - некоторые значения сохраняются в памяти с некоторой погрешностью. Хорошей иллюстрацией этой проблемы являются денежные вычисления. Если необходима высокая точность, следует использовать другие типы. Например, в Java 7 уже предусмотрен класс `BigDecimal`.

```java
import java.math.BigDecimal;

public class FloatTest {
    public static void main(String[] args) {
        float accountBalance = 10000.00f;
        System.out.println("Операции с использованием типа float:");
        System.out.println("10000 операций со значением 1,99");
        for (int i = 0; i < 1000; i++) {
            accountBalance -= 1.99f;
        }
        System.out.println(String.format("Остаток на счете после операций с плавающей запятой: %f", accountBalance));
        
        BigDecimal accountBalanceTwo = new BigDecimal("10000.00");
        System.out.println("Операции с использованием BigDecimal:");
        System.out.println("1000 операций со значением 1.99");
        BigDecimal operation = new BigDecimal("1.99");
        for (int i = 0; i < 1000; i++) {
            accountBalanceTwo = accountBalanceTwo.subtract(operation);
        }
        System.out.println(String.format("Остаток на счете после операций BigDecimal: %f", accountBalanceTwo));
    }
}
```

После завершения работы программа выдаст следующий результат:

```bash
Операции с использование float:
1000 операций с 1,99
Остаток на счете после операций с плавающей запятой: 8009,765625
Операции с использованием BigDecimal:
1000 операций со значением 1.99
Остаток на счете после операций BigDecimal: 8010,000000
```

Для начального баланса 10000,00 после 1000 операций со значением 1,99 баланс должен быть 8010,00. Использование типа `float` даёт результат, примерно равный 8009,77, что приемлемо для денежных вычислений. Использование класса `BigDecimal` даёт правильный результат.

[к оглавлению Глава 19](#глава-19-класс-bigdecimal)

## Раздел 19.3. Метод BigDecimal.valueOf()

Класс `BigDecimal` содержит внутренний кеш часто используемых чисел, например, чисел от 0 до 10. Поэтому лучше использовать метод `BigDecimal.valueOf()`, а не конструктор с аналогичным параметром, т.е. в приведённом ниже примере способ инициализации числа `a` предпочтительнее способа инициализации числа `b`.

```java
import java.math.BigDecimal;

BigDecimal a = BigDecimal.valueOf(10L); // Возвращает ссылку на объект, помещённый в кеш
BigDecimal b = new BigDecimal(10L); // Не возвращает ссылку на объект, помещённый в кеш

BigDecimal a = BigDecimal.valueOf(20L); // Не возвращает ссылку на объект, помещённый в кеш
BigDecimal b = new BigDecimal(20L); // Не возвращает ссылку на объект, помещённый в кеш

BigDecimal a = BigDecimal.valueOf(15.15); // Предпочтительный способ преобразования
// типа double (или типа float) в BigDecimal, поскольку возвращаемое значение равно
// значению, полученному при создании BigDecimal на основе результата использования
// метода Double.toString(double)

BigDecimal b = new BigDecimal(15.15); // Выдаст непредсказуемый результат
```

[к оглавлению Глава 19](#глава-19-класс-bigdecimal)

## Раздел 19.4. Математические операции с большими числами (BigDecimal)



[к оглавлению Глава 19](#глава-19-класс-bigdecimal)

[Раздел 19.1. Сравнение больших чисел](#раздел-191-сравнение-больших-чисел)

[Раздел 19.2. Использование значений BigDecimal вместо значений типа float](#раздел-192-использование-значений-bigdecimal-вместо-значений-типа-float)

[Раздел 19.4. Математические операции с большими числами (BigDecimal)](#раздел-194-математические-операции-с-большими-числами-bigdecimal)

















